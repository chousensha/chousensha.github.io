
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>dnsenum - Kali Linux tools - Core dump overflow</title>
  <meta name="author" content="chousensha">

  
  
  <meta name="description" content="dnsenum tutorial">
  <meta name="keywords" content="dnsenum, dnsenum tutorial, dnsenum kali, dnsenum kali linux, dns, dnsenum usage, kali dnsenum">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://chousensha.github.io/blog/2017/05/29/dnsenum-kali-linux-tools">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Core dump overflow" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-51216602-2']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Core dump overflow</a></h1>
  
    <h2>Core dump in progress...</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:chousensha.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/where-to-start">Where to start</a></li>
  <li><a href="/book-corner">Book corner</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">dnsenum - Kali Linux tools</h1>
    
    
      <p class="meta">
        








  


<time datetime="2017-05-29T05:32:26-04:00" pubdate data-updated="true">May 29<span>th</span>, 2017</time>
        
           | <a href="#disqus_thread"
             data-disqus-identifier="http://chousensha.github.io">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><p>Today we&rsquo;ll look at dnsenum, one of the tools that come preinstalled on Kali for DNS information gathering.</p>

<!-- more -->


<p>Homepage: <a href="https://github.com/fwaeytens/dnsenum">https://github.com/fwaeytens/dnsenum</a></p>

<h3>dnsenum description</h3>

<blockquote><p>multithreaded perl script to enumerate DNS information of a domain and to discover non-contiguous ip blocks.</p>

<p>OPERATIONS:</p>

<p>1) Get the host&rsquo;s addresse (A record).</p>

<p>2) Get the namservers (threaded).</p>

<p>3) Get the MX record (threaded).</p>

<p>4) Perform axfr queries on nameservers and get BIND VERSION (threaded).</p>

<p>5) Get extra names and subdomains via google scraping (google query = &ldquo;allinurl: -www site:domain&rdquo;).</p>

<p>6) Brute force subdomains from file, can also perform recursion on subdomain that have NS records (all threaded).</p>

<p>7) Calculate C class domain network ranges and perform whois queries on them (threaded).</p>

<p>8) Perform reverse lookups on netranges ( C class or/and whois netranges) (threaded).</p>

<p>9) Write to domain_ips.txt file ip-blocks.</p></blockquote>

<h3>dnsenum options</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>dnsenum -h
</span><span class='line'>dnsenum.pl VERSION:1.2.3
</span><span class='line'>Usage: dnsenum.pl [Options] &lt;domain&gt;
</span><span class='line'>[Options]:
</span><span class='line'>Note: the brute force -f switch is obligatory.
</span><span class='line'>GENERAL OPTIONS:
</span><span class='line'>  --dnsserver     &lt;server&gt;
</span><span class='line'>          Use this DNS server for A, NS and MX queries.
</span><span class='line'>  --enum      Shortcut option equivalent to --threads 5 -s 15 -w.
</span><span class='line'>  -h, --help      Print this help message.
</span><span class='line'>  --noreverse     Skip the reverse lookup operations.
</span><span class='line'>  --nocolor       Disable ANSIColor output.
</span><span class='line'>  --private       Show and save private ips at the end of the file domain_ips.txt.
</span><span class='line'>  --subfile &lt;file&gt;  Write all valid subdomains to this file.
</span><span class='line'>  -t, --timeout &lt;value&gt; The tcp and udp timeout values in seconds (default: 10s).
</span><span class='line'>  --threads &lt;value&gt; The number of threads that will perform different queries.
</span><span class='line'>  -v, --verbose       Be verbose: show all the progress and all the error messages.
</span><span class='line'>GOOGLE SCRAPING OPTIONS:
</span><span class='line'>  -p, --pages &lt;value&gt;   The number of google search pages to process when scraping names,
</span><span class='line'>          the default is 5 pages, the -s switch must be specified.
</span><span class='line'>  -s, --scrap &lt;value&gt;   The maximum number of subdomains that will be scraped from Google (default 15).
</span><span class='line'>BRUTE FORCE OPTIONS:
</span><span class='line'>  -f, --file &lt;file&gt; Read subdomains from this file to perform brute force.
</span><span class='line'>  -u, --update    &lt;a|g|r|z&gt;
</span><span class='line'>          Update the file specified with the -f switch with valid subdomains.
</span><span class='line'>  a (all)     Update using all results.
</span><span class='line'>  g       Update using only google scraping results.
</span><span class='line'>  r       Update using only reverse lookup results.
</span><span class='line'>  z       Update using only zonetransfer results.
</span><span class='line'>  -r, --recursion Recursion on subdomains, brute force all discovred subdomains that have an NS record.
</span><span class='line'>WHOIS NETRANGE OPTIONS:
</span><span class='line'>  -d, --delay &lt;value&gt;   The maximum value of seconds to wait between whois queries, the value is defined randomly, default: 3s.
</span><span class='line'>  -w, --whois     Perform the whois queries on c class network ranges.
</span><span class='line'>           **Warning**: this can generate very large netranges and it will take lot of time to performe reverse lookups.
</span><span class='line'>REVERSE LOOKUP OPTIONS:
</span><span class='line'>  -e, --exclude   &lt;regexp&gt;
</span><span class='line'>          Exclude PTR records that match the regexp expression from reverse lookup results, useful on invalid hostnames.
</span><span class='line'>OUTPUT OPTIONS:
</span><span class='line'>  -o --output &lt;file&gt;    Output in XML format. Can be imported in MagicTree (www.gremwell.com)</span></code></pre></td></tr></table></div></figure>


<h3>Fix dnsenum whois and autoloader errors</h3>

<p>First, some preliminary troubleshooting information: dnsenum relies on some Perl modules that may not be already on your system. When running it with certain flags, you might see some warnings like this one: Warning: can&rsquo;t load Net::Whois::IP module, whois queries disabled. To fix it, install the module by running <code>perl -MCPAN -e shell</code> and then at the prompt: <code>install Net::Whois::IP</code>. If you try again, you might get a different error, however: Can&rsquo;t locate package AutoLoader for @net::Whois::IP::ISA at /usr/bin/dnsenum line 536. I scoured the Internet for a bit before finding a workaround: you can make it go away by adding <code>require AutoLoader;</code> to the module source code, or by removing the Autuloader reference: changing <code>@ISA = qw(Exporter AutoLoader);</code> to <code>@ISA = qw(Exporter);</code>. To find out where the module is located, use the CPAN tool:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cpan -D Net::Whois::IP
</span><span class='line'>Loading internal null logger. Install Log::Log4perl for logging messages
</span><span class='line'>Reading '/root/.cpan/Metadata'
</span><span class='line'>  Database was generated on Wed, 17 May 2017 06:54:04 GMT
</span><span class='line'>Net::Whois::IP
</span><span class='line'>-------------------------------------------------------------------------
</span><span class='line'>  (no description)
</span><span class='line'>  B/BS/BSCHMITZ/Net-Whois-IP-1.19.tar.gz
</span><span class='line'>  /usr/local/share/perl/5.24.1/Net/Whois/IP.pm
</span><span class='line'>  Installed: 1.19
</span><span class='line'>  CPAN:      1.19  up to date
</span><span class='line'>  Ben Schmitz (BSCHMITZ)
</span><span class='line'>  ben@foink.com</span></code></pre></td></tr></table></div></figure>


<p>You can see the path here, now go apply the fix in the IP.pm file and the error should go away.</p>

<h3>dnsenum usage</h3>

<ul>
<li>default</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>dnsenum yahoo.com
</span><span class='line'>dnsenum.pl VERSION:1.2.3
</span><span class='line'>
</span><span class='line'>-----   yahoo.com   -----
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>Host's addresses:
</span><span class='line'>__________________
</span><span class='line'>
</span><span class='line'>yahoo.com.                               5        IN    A        206.190.36.45
</span><span class='line'>yahoo.com.                               5        IN    A        98.139.183.24
</span><span class='line'>yahoo.com.                               5        IN    A        98.138.253.109
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>Name Servers:
</span><span class='line'>______________
</span><span class='line'>
</span><span class='line'>ns1.yahoo.com.                           5        IN    A        68.180.131.16
</span><span class='line'>ns3.yahoo.com.                           5        IN    A        203.84.221.53
</span><span class='line'>ns4.yahoo.com.                           5        IN    A        98.138.11.157
</span><span class='line'>ns2.yahoo.com.                           5        IN    A        68.142.255.16
</span><span class='line'>ns5.yahoo.com.                           5        IN    A        119.160.247.124
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>Mail (MX) Servers:
</span><span class='line'>___________________
</span><span class='line'>
</span><span class='line'>mta7.am0.yahoodns.net.                   5        IN    A        98.138.112.32
</span><span class='line'>mta7.am0.yahoodns.net.                   5        IN    A        98.138.112.37
</span><span class='line'>mta7.am0.yahoodns.net.                   5        IN    A        63.250.192.45
</span><span class='line'>mta7.am0.yahoodns.net.                   5        IN    A        66.196.118.34
</span><span class='line'>mta7.am0.yahoodns.net.                   5        IN    A        66.196.118.37
</span><span class='line'>mta7.am0.yahoodns.net.                   5        IN    A        66.196.118.240
</span><span class='line'>mta7.am0.yahoodns.net.                   5        IN    A        98.136.216.26
</span><span class='line'>mta7.am0.yahoodns.net.                   5        IN    A        98.136.217.202
</span><span class='line'>mta5.am0.yahoodns.net.                   5        IN    A        98.138.112.33
</span><span class='line'>mta5.am0.yahoodns.net.                   5        IN    A        98.138.112.34
</span><span class='line'>mta5.am0.yahoodns.net.                   5        IN    A        66.196.118.33
</span><span class='line'>mta5.am0.yahoodns.net.                   5        IN    A        66.196.118.34
</span><span class='line'>mta5.am0.yahoodns.net.                   5        IN    A        66.196.118.35
</span><span class='line'>mta5.am0.yahoodns.net.                   5        IN    A        66.196.118.36
</span><span class='line'>mta5.am0.yahoodns.net.                   5        IN    A        98.136.216.25
</span><span class='line'>mta5.am0.yahoodns.net.                   5        IN    A        98.136.217.202
</span><span class='line'>mta6.am0.yahoodns.net.                   5        IN    A        98.136.216.25
</span><span class='line'>mta6.am0.yahoodns.net.                   5        IN    A        98.138.112.38
</span><span class='line'>mta6.am0.yahoodns.net.                   5        IN    A        98.138.112.37
</span><span class='line'>mta6.am0.yahoodns.net.                   5        IN    A        98.136.217.203
</span><span class='line'>mta6.am0.yahoodns.net.                   5        IN    A        98.138.112.35
</span><span class='line'>mta6.am0.yahoodns.net.                   5        IN    A        66.196.118.36
</span><span class='line'>mta6.am0.yahoodns.net.                   5        IN    A        63.250.192.46
</span><span class='line'>mta6.am0.yahoodns.net.                   5        IN    A        66.196.118.37
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>Trying Zone Transfers and getting Bind Versions:
</span><span class='line'>_________________________________________________
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>Trying Zone Transfer for yahoo.com on ns4.yahoo.com ...
</span><span class='line'>AXFR record query failed: REFUSED
</span><span class='line'>
</span><span class='line'>Trying Zone Transfer for yahoo.com on ns5.yahoo.com ...
</span><span class='line'>AXFR record query failed: REFUSED
</span><span class='line'>
</span><span class='line'>Trying Zone Transfer for yahoo.com on ns2.yahoo.com ...
</span><span class='line'>AXFR record query failed: REFUSED
</span><span class='line'>
</span><span class='line'>Trying Zone Transfer for yahoo.com on ns3.yahoo.com ...
</span><span class='line'>AXFR record query failed: REFUSED
</span><span class='line'>
</span><span class='line'>Trying Zone Transfer for yahoo.com on ns1.yahoo.com ...
</span><span class='line'>AXFR record query failed: REFUSED
</span><span class='line'>
</span><span class='line'>brute force file not specified, bay.</span></code></pre></td></tr></table></div></figure>


<p>From this output, you can see that the script performed DNS queries of the yahoo.com domain, enumerated the DNS and mail servers, and attempted zone transfers through the AXFR record type. Successful zone transfers are a misconfiguration that can have serious security impacts, because the DNS server sends its zone records to whoever requested them, thus revealing potentially sensitive information about the internal network topology, etc.</p>

<ul>
<li>with the &mdash;enum shortcut, which includes the flags: &mdash;threads 5 (5 threads), -s 15 (15 maximum subdomains to be scraped from Google), and -w (perform whois queries on class C ranges)</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>dnsenum --enum kali.org
</span><span class='line'>dnsenum.pl VERSION:1.2.3
</span><span class='line'>
</span><span class='line'>-----   kali.org   -----
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>Host's addresses:
</span><span class='line'>__________________
</span><span class='line'>
</span><span class='line'>kali.org.                                5        IN    A        192.124.249.10
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>Name Servers:
</span><span class='line'>______________
</span><span class='line'>
</span><span class='line'>ns5.no-ip.com.                           5        IN    A        204.16.255.155
</span><span class='line'>ns4.no-ip.com.                           5        IN    A        204.16.254.44
</span><span class='line'>ns1.no-ip.com.                           5        IN    A        204.16.255.55
</span><span class='line'>ns3.no-ip.com.                           5        IN    A        207.34.6.1
</span><span class='line'>ns2.no-ip.com.                           5        IN    A        204.16.254.6
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>Mail (MX) Servers:
</span><span class='line'>___________________
</span><span class='line'>
</span><span class='line'>aspmx.l.google.com.                      5        IN    A        108.177.15.27
</span><span class='line'>alt3.aspmx.l.google.com.                 5        IN    A        74.125.23.26
</span><span class='line'>alt4.aspmx.l.google.com.                 5        IN    A        74.125.28.26
</span><span class='line'>alt1.aspmx.l.google.com.                 5        IN    A        108.177.14.27
</span><span class='line'>alt2.aspmx.l.google.com.                 5        IN    A        74.125.200.27
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>Trying Zone Transfers and getting Bind Versions:
</span><span class='line'>_________________________________________________
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>Trying Zone Transfer for kali.org on ns2.no-ip.com ... 
</span><span class='line'>AXFR record query failed: REFUSED
</span><span class='line'>
</span><span class='line'>Trying Zone Transfer for kali.org on ns4.no-ip.com ... 
</span><span class='line'>AXFR record query failed: REFUSED
</span><span class='line'>
</span><span class='line'>Trying Zone Transfer for kali.org on ns3.no-ip.com ... 
</span><span class='line'>AXFR record query failed: REFUSED
</span><span class='line'>
</span><span class='line'>Trying Zone Transfer for kali.org on ns1.no-ip.com ... 
</span><span class='line'>AXFR record query failed: NOTAUTH
</span><span class='line'>
</span><span class='line'>Trying Zone Transfer for kali.org on ns5.no-ip.com ... 
</span><span class='line'>AXFR record query failed: NOTAUTH
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>Scraping kali.org subdomains from Google:
</span><span class='line'>__________________________________________
</span><span class='line'>
</span><span class='line'>
</span><span class='line'> ----   Google search page: 1   ---- 
</span><span class='line'>
</span><span class='line'>
</span><span class='line'> ----   Google search page: 2   ---- 
</span><span class='line'>
</span><span class='line'>  docs
</span><span class='line'>
</span><span class='line'> ----   Google search page: 3   ---- 
</span><span class='line'>
</span><span class='line'>  de.docs
</span><span class='line'>  archive
</span><span class='line'>
</span><span class='line'> ----   Google search page: 4   ---- 
</span><span class='line'>
</span><span class='line'>  archive-4
</span><span class='line'>  ja.docs
</span><span class='line'>
</span><span class='line'> ----   Google search page: 5   ---- 
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>Google Results:
</span><span class='line'>________________
</span><span class='line'>
</span><span class='line'>de.docs.kali.org.                        5        IN    A        192.124.249.10
</span><span class='line'>ja.docs.kali.org.                        5        IN    A        192.124.249.10
</span><span class='line'>docs.kali.org.                           5        IN    A        192.124.249.10
</span><span class='line'>archive.kali.org.                        5        IN    CNAME    hera.kali.org.
</span><span class='line'>hera.kali.org.                           5        IN    A        192.99.45.140
</span><span class='line'>archive-4.kali.org.                      5        IN    CNAME    hecate.kali.org.
</span><span class='line'>hecate.kali.org.                         5        IN    A        149.202.201.51
</span><span class='line'>
</span><span class='line'>brute force file not specified, bay.</span></code></pre></td></tr></table></div></figure>


<p>One thing that you should keep in mind is that the Google scraping feature might not always work. In that case, you can check manually by using the same Google operator that dnsenum uses, with &ldquo;allinurl:-www site:target.com&rdquo;</p>

<ul>
<li>bruteforce subdomains and perform whois queries</li>
</ul>


<p>dnsenum has a domain bruteforce file located at <code>/usr/share/dnsenum/dns.txt</code>:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>wc -l /usr/share/dnsenum/dns.txt 
</span><span class='line'>1480 /usr/share/dnsenum/dns.txt</span></code></pre></td></tr></table></div></figure>


<p>Let&rsquo;s see some domain bruteforcing in action! Again, looking at kali.org:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>dnsenum -f /usr/share/dnsenum/dns.txt -w --noreverse kali.org
</span><span class='line'>[...]
</span><span class='line'>Brute forcing with /usr/share/dnsenum/dns.txt:
</span><span class='line'>_______________________________________________
</span><span class='line'>
</span><span class='line'>archive.kali.org.                        5        IN    CNAME    hera.kali.org.
</span><span class='line'>hera.kali.org.                           5        IN    A        192.99.45.140
</span><span class='line'>bugs.kali.org.                           5        IN    A        198.50.203.236
</span><span class='line'>bugs.kali.org.                           5        IN    A        198.50.203.235
</span><span class='line'>forums.kali.org.                         5        IN    A        192.124.249.12
</span><span class='line'>hermes.kali.org.                         5        IN    A        198.27.70.128
</span><span class='line'>http.kali.org.                           5        IN    CNAME    hebe.kali.org.
</span><span class='line'>hebe.kali.org.                           5        IN    A        192.99.200.113
</span><span class='line'>mail.kali.org.                           5        IN    CNAME    apollo.kali.org.
</span><span class='line'>apollo.kali.org.                         5        IN    A        23.239.31.82
</span><span class='line'>old.kali.org.                            5        IN    CNAME    hermes.kali.org.
</span><span class='line'>hermes.kali.org.                         5        IN    A        198.27.70.128
</span><span class='line'>pan.kali.org.                            5        IN    A        167.114.101.148
</span><span class='line'>shop.kali.org.                           5        IN    A        45.79.147.167
</span><span class='line'>www.kali.org.                            5        IN    A        192.124.249.10
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>Launching Whois Queries:
</span><span class='line'>_________________________
</span><span class='line'>
</span><span class='line'> whois ip result:   23.239.31.0        -&gt;      23.239.0.0/19
</span><span class='line'> whois ip result:   45.79.147.0        -&gt;      45.79.0.0/16
</span><span class='line'> whois ip result:   167.114.101.0      -&gt;      167.114.0.0/16
</span><span class='line'> whois ip result:   192.99.45.0        -&gt;      192.99.0.0/16
</span><span class='line'> whois ip result:   192.124.249.0      -&gt;      192.124.249.0/24
</span><span class='line'> whois ip result:   198.27.70.0        -&gt;      198.27.64.0/18
</span><span class='line'> whois ip result:   198.50.203.0       -&gt;      198.50.203.0/27
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>kali.org________
</span><span class='line'>
</span><span class='line'> 192.99.0.0/16
</span><span class='line'> 23.239.0.0/19
</span><span class='line'> 45.79.0.0/16
</span><span class='line'> 198.50.203.0/27
</span><span class='line'> 192.124.249.0/24
</span><span class='line'> 167.114.0.0/16
</span><span class='line'> 198.27.64.0/18
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>kali.org ip blocks:
</span><span class='line'>____________________
</span><span class='line'>
</span><span class='line'> 23.239.31.82/32
</span><span class='line'> 45.79.147.167/32
</span><span class='line'> 167.114.101.148/32
</span><span class='line'> 192.99.45.140/32
</span><span class='line'> 192.99.200.113/32
</span><span class='line'> 192.124.249.10/32
</span><span class='line'> 192.124.249.12/32
</span><span class='line'> 198.27.70.128/32
</span><span class='line'> 198.50.203.235/32
</span><span class='line'> 198.50.203.236/32
</span><span class='line'>
</span><span class='line'>done.</span></code></pre></td></tr></table></div></figure>


<p>And today&rsquo;s cow saying is:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>/ Tomorrow, this will be part of the    \
</span><span class='line'>| unchangeable past but fortunately, it |
</span><span class='line'>\ can still be changed today.           /
</span><span class='line'> ---------------------------------------
</span><span class='line'>        \   ^__^
</span><span class='line'>         \  (oo)\_______
</span><span class='line'>            (__)\       )\/\
</span><span class='line'>                ||----w |
</span><span class='line'>                ||     ||</span></code></pre></td></tr></table></div></figure>



</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">chousensha</span></span>

      








  


<time datetime="2017-05-29T05:32:26-04:00" pubdate data-updated="true">May 29<span>th</span>, 2017</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/penetration-testing/'>penetration testing</a>, <a class='category' href='/blog/categories/tools/'>tools</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://chousensha.github.io/blog/2017/05/29/dnsenum-kali-linux-tools/" data-via="chous3nsha" data-counturl="http://chousensha.github.io/blog/2017/05/29/dnsenum-kali-linux-tools/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2017/05/23/iptables-firewall/" title="Previous Post: iptables firewall">&laquo; iptables firewall</a>
      
      
        <a class="basic-alignment right" href="/blog/2017/06/06/tr0ll-2-there-be-trolls/" title="Next Post: Tr0ll 2 - There be trolls">Tr0ll 2 - There be trolls &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>whoami</h1>
  <p>switch (interests){<br>
 case INFORMATION SECURITY:<br>
Mostly offensive security, but trying to be well-rounded in everything;<br>
case PYTHON:<br>
Mainly security and sysadmin related scripting;<br>
case LINUX:<br>
Greetings from /dev/null;<br>
case JAPANESE:<br>
Language, anime, samurai;<br>
case MARTIAL ARTS:<br>
If it's fighting I like it;<br>
case MILITARY SCIENCE:<br>
Ancient, medieval, modern;<br>
default: GAMING;}</p>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2018/11/16/hackfest-2016-sedna/">Hackfest 2016: Sedna</a>
      </li>
    
      <li class="post">
        <a href="/blog/2018/11/11/social-engineering-expert-course-review/">Social Engineering Expert course review</a>
      </li>
    
      <li class="post">
        <a href="/blog/2018/11/10/take-the-spydersec-challenge/">Take the SpyderSec Challenge</a>
      </li>
    
      <li class="post">
        <a href="/blog/2018/10/26/all-your-64base-are-belong-to-us/">All your 64Base are belong to us</a>
      </li>
    
      <li class="post">
        <a href="/blog/2018/10/20/skydog-con-ctf-2016-catch-me-if-you-can/">SkyDog Con CTF 2016 - Catch Me If You Can</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/chousensha">@chousensha</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'chousensha',
            count: 5,
            skip_forks: true,
	    skip_repos: [ "chousensha.github.io" ],
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <a class="twitter-timeline" data-dnt="true" href="https://twitter.com/chous3nsha" data-widget-id="733738822597550081" data-link-color="#1863a1" data-tweet-limit="3" data-chrome="noheader nofooter transparent noscrollbar">Tweets by @chous3nsha</a>
    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
  </ul>
  
    <a href="http://twitter.com/chous3nsha" class="twitter-follow-button" data-show-count="true">Follow @chous3nsha</a>
  
</section>

<section>
  <h1>Blogroll</h1>
  <p><a href="https://blog.g0tmi1k.com/">g0tmi1k</a></p>
  <p><a href="http://redteamjournal.com/">Red Team Journal</a></p>
  <p><a href="https://www.corelan.be/">Corelan Team</a></p>
  <p><a href="http://www.madirish.net/">Mad Irish</a></p>
  <p><a href="http://redteams.net/blog/">redteams.net</a></p>
  <p><a href="https://www.mattandreko.com/">MattAndreko.com</a></p>
  <p><a href="http://blog.portswigger.net/">Portswigger Web Security</a></p>
  <p><a href="http://blog.cobaltstrike.com/">Cobalt Strike blog</a></p>
  <p><a href="https://highon.coffee/blog/">HighOn.Coffee</a></p>
  <p><a href="https://pentestlab.blog/">Penetration Testing Lab</a></p
</section>

  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2018 - chousensha -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'coredumpoverflow';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://chousensha.github.io/blog/2017/05/29/dnsenum-kali-linux-tools/';
        var disqus_url = 'http://chousensha.github.io/blog/2017/05/29/dnsenum-kali-linux-tools/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
